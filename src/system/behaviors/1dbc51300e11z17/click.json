{
	"component": "1dbc51300e11z17",
	"state": "click",
	"action": "function click() {\n  $('#designer-toolbar-item-search').tooltip('hide');\n  \n  var message = this.require('message');\n  var Dialog = this.require('DialogSearch');\n  \n  if (this.require('designer').system()) {\n    var dialog = new Dialog({\n        'title': 'Search',\n    });\n    dialog.show();\n    \n    dialog.on('ok', function click() {\n      this.hide();\n    });\n    \n    dialog.on('filter', function filter(value) {\n      var systemId = this.require('designer').system().id(),\n          schemas = this.require('designer').system().schemas(),\n          models = this.require('designer').system().models(),\n          types = this.require('designer').system().types(),\n          behaviors = this.require('designer').system().behaviors(),\n          components = this.require('designer').system().components(),\n          collection = '',\n          id = '',\n          toSearch = '',\n          index = -1,\n          result = [];\n      \n      // clean\n      document.getElementById('designer-dialog-search-result').innerHTML = '';\n\n      if (value.length > 0 && value.trim() !== '') {\n        if (this.inContent()) {\n          \n          // schema\n          for (id in schemas) {\n            toSearch = JSON.stringify(schemas[id]);\n            index = toSearch.toLowerCase().indexOf(value.toLowerCase());\n            if (index !=-1) {\n              link = '<a href=\"#' + systemId + '#schemas#' + id + '\" class=\"list-group-item\" class=\"list-group-item active\">' +\n                '<h4 class=\"list-group-item-heading\">Schema ' + schemas[id]._name + '</h4>' +\n                '<p class=\"list-group-item-text\">...' + toSearch.substring(index - 20, index + value.length + 20) + '...</p>' +\n                '</a>';\n              \n              result.push(link);\n            }\n          }\n          \n          // model\n          for (id in models) {\n            toSearch = JSON.stringify(models[id]);\n            index = toSearch.toLowerCase().indexOf(value.toLowerCase());\n            if (index !=-1) {\n              link = '<a href=\"#' + systemId + '#models#' + id + '\" class=\"list-group-item\" class=\"list-group-item active\">' +\n                '<h4 class=\"list-group-item-heading\">Model ' + models[id]._name + '</h4>' +\n                '<p class=\"list-group-item-text\">...' + toSearch.substring(index - 20, index + value.length + 20) + '...</p>' +\n                '</a>';\n              \n              result.push(link);\n            }\n          }\n          \n          // type\n          for (id in types) {\n            toSearch = JSON.stringify(types[id]);\n            index = toSearch.toLowerCase().indexOf(value.toLowerCase());\n            if (index !=-1) {\n              link = '<a href=\"#' + systemId + '#types#' + types[id].name + '\" class=\"list-group-item\" class=\"list-group-item active\">' +\n                '<h4 class=\"list-group-item-heading\">Type ' + types[id].name + '</h4>' +\n                '<p class=\"list-group-item-text\">...' + toSearch.substring(index - 20, index + value.length + 20) + '...</p>' +\n                '</a>';\n              \n              result.push(link);\n            }\n          }\n          \n          // behavior\n          for (id in behaviors) {\n            toSearch = behaviors[id].action;\n            index = toSearch.toLowerCase().indexOf(value.toLowerCase());\n            if (index !=-1) {\n              link = '<a href=\"#' + systemId + '#behaviors#' + behaviors[id].component + '#' + behaviors[id].state +'\" class=\"list-group-item\" class=\"list-group-item active\">' +\n                '<h4 class=\"list-group-item-heading\">Behavior ' + behaviors[id].component + '.' + behaviors[id].state + '</h4>' +\n                '<p class=\"list-group-item-text\">...' + toSearch.substring(index - 20, index + value.length + 20) + '...</p>' +\n                '</a>';\n              \n              result.push(link);\n            }\n          }\n          \n          // components\n          for (collection in components) {\n            for (id in components[collection]) {\n              toSearch = JSON.stringify(components[collection][id]);\n              index = toSearch.toLowerCase().indexOf(value.toLowerCase());\n              if (index !=-1) {\n                link = '<a href=\"#' + systemId + '#components#' + collection + '#' + id +'\" class=\"list-group-item\" class=\"list-group-item active\">' +\n                  '<h4 class=\"list-group-item-heading\">Component ' + components[collection][id]._id + '</h4>' +\n                  '<p class=\"list-group-item-text\">...' + toSearch.substring(index - 20, index + value.length + 20).replace('<', '&lt;') + '...</p>' +\n                  '</a>';\n                \n                result.push(link);\n              }\n            }\n          }\n          \n        } else {\n          // schema\n          for (id in schemas) {\n            if (schemas[id]._name.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n              result.push('<a href=\"#' + systemId + '#schemas#' + id + '\" class=\"list-group-item\"><h4 class=\"list-group-item-heading\">Schema ' + schemas[id]._name + '</h4></a>');\n            }\n          }\n          \n          // model\n          for (id in models) {\n            if (models[id]._name.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n              result.push('<a href=\"#' + systemId + '#models#' + id + '\" class=\"list-group-item\"><h4 class=\"list-group-item-heading\">Model ' + models[id]._name + '</h4></a>');\n            }\n          }\n          \n          // type\n          for (id in types) {\n            if (types[id].name.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n              result.push('<a href=\"#' + systemId + '#types#' + types[id].name + '\" class=\"list-group-item\"><h4 class=\"list-group-item-heading\">Type ' + types[id].name + '</h4></a>');\n            }\n          }\n          \n          // behaviors\n          for (id in behaviors) {\n            if (behaviors[id].state.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n              result.push('<a href=\"#' + systemId + '#behaviors#' + behaviors[id].component + '#' + behaviors[id].state +'\" class=\"list-group-item\"><h4 class=\"list-group-item-heading\">Behavior ' + behaviors[id].component + '.' + behaviors[id].state + '</h4></a>');\n            }\n          }\n          \n          // components\n          for (collection in components) {\n            for (id in components[collection]) {\n              if (components[collection][id]._id.toLowerCase().indexOf(value.toLowerCase()) !== -1) {\n                result.push('<a href=\"#' + systemId + '#components#' + collection + '#' + id +'\" class=\"list-group-item\" class=\"list-group-item\"><h4 class=\"list-group-item-heading\">Component ' + components[collection][id]._id + '</h4></a>');\n              }\n            }\n          }\n        }\n        \n        // result\n        document.getElementById('designer-dialog-search-result').innerHTML = result.join(' ');\n      }\n    });\n  } else {\n    message.warning('There is no system.');\n  }\n}"
}
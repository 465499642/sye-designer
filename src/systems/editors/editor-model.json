{
  "name": "editor-model",
  "master": true,
  "subsystem": false,
  "version": "1.0.0",
  "description": "",
  "schemas": {
    "t19b6b11ff31158d": {
      "_name": "ToolBarItem",
      "html": "link",
      "position": "property",
      "type": "property",
      "hide": "method",
      "show": "method",
      "render": "method",
      "click": "event",
      "_id": "t19b6b11ff31158d",
      "_inherit": [
        "_Component"
      ]
    },
    "p1f6f51d9f111925": {
      "_name": "MenuAction",
      "html": "link",
      "position": "property",
      "type": "property",
      "hide": "method",
      "show": "method",
      "render": "method",
      "_id": "p1f6f51d9f111925",
      "_inherit": [
        "_Component"
      ]
    },
    "t14a79156a81862a": {
      "_name": "MenuHeader",
      "html": "link",
      "type": "property",
      "hide": "method",
      "show": "method",
      "render": "method",
      "_id": "t14a79156a81862a",
      "_inherit": [
        "_Component"
      ]
    },
    "l1d113198721599d": {
      "_name": "MenuItem",
      "html": "link",
      "position": "property",
      "type": "property",
      "name": "property",
      "hide": "method",
      "show": "method",
      "render": "method",
      "click": "event",
      "_id": "l1d113198721599d",
      "_inherit": [
        "_Component"
      ]
    },
    "f1092816b571e03c": {
      "_name": "Workspace",
      "create": "method",
      "load": "method",
      "clear": "method",
      "refresh": "method",
      "render": "method",
      "_id": "f1092816b571e03c",
      "_inherit": [
        "_Component"
      ]
    },
    "k1b97018e111d0e3": {
      "_name": "Server",
      "start": "method",
      "_id": "k1b97018e111d0e3",
      "_inherit": [
        "_Component"
      ]
    },
    "o1ead8184af1a83e": {
      "_name": "Designer",
      "_inherit": [
        "_Component"
      ],
      "version": "property",
      "context": "property",
      "oldContext": "property",
      "space": "property",
      "system": "property",
      "debug": "property",
      "filter": "property",
      "type": "property",
      "state": "property",
      "runWindow": "property",
      "debugWindow": "property",
      "updateRouter": "method",
      "syncModel": "method",
      "syncBehavior": "method",
      "syncComponent": "method",
      "createModel": "method",
      "createBehavior": "method",
      "deleteSchema": "method",
      "linkModel": "method",
      "save": "method",
      "saveCordova": "method",
      "saveAs": "method",
      "welcome": "method",
      "generateId": "method",
      "open": "method",
      "render": "event",
      "logs": "collection",
      "isCordova": "method",
      "isElectron": "method",
      "updateCordovaContext": "method",
      "messages": "property",
      "runMessages": "method",
      "lastPage": "property",
      "getGeneratedSchema": "method",
      "getGeneratedModel": "method",
      "mergeBehavior": "method",
      "_id": "o1ead8184af1a83e"
    }
  },
  "models": {
    "u1f4c7177bb1a459": {
      "_name": "ToolBarItem",
      "html": {
        "type": "@HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "position": {
        "type": "number",
        "readOnly": false,
        "mandatory": false,
        "default": 0
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "hide": {},
      "show": {},
      "render": {},
      "click": {},
      "_id": "u1f4c7177bb1a459"
    },
    "w124ac16b591df57": {
      "_name": "MenuAction",
      "html": {
        "type": "@HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "position": {
        "type": "number",
        "readOnly": false,
        "mandatory": false,
        "default": 0
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "hide": {},
      "show": {},
      "render": {},
      "_id": "w124ac16b591df57"
    },
    "f13ebe1ad331b263": {
      "_name": "MenuHeader",
      "html": {
        "type": "@HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "hide": {},
      "show": {},
      "render": {},
      "_id": "f13ebe1ad331b263"
    },
    "u1f9a01abe31b3bf": {
      "_id": "u1f9a01abe31b3bf",
      "_name": "MenuItem",
      "html": {
        "type": "@HTML",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "position": {
        "type": "number",
        "readOnly": false,
        "mandatory": false,
        "default": 0
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "name": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "hide": {},
      "show": {},
      "render": {},
      "click": {}
    },
    "v1435e1809e10be7": {
      "_id": "v1435e1809e10be7",
      "_name": "Workspace",
      "create": {},
      "load": {},
      "clear": {},
      "render": {}
    },
    "e1ca371b8a41af7b": {
      "_id": "e1ca371b8a41af7b",
      "_name": "Server",
      "start": {}
    },
    "q129be1c61b18285": {
      "_id": "q129be1c61b18285",
      "_name": "Designer",
      "version": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": "2.0.0-alpha.1"
      },
      "context": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "oldContext": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "space": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "system": {
        "type": "@System",
        "readOnly": false,
        "mandatory": false,
        "default": {}
      },
      "debug": {
        "type": "boolean",
        "readOnly": false,
        "mandatory": false,
        "default": false
      },
      "filter": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": ""
      },
      "type": {
        "type": "editorType",
        "readOnly": false,
        "mandatory": false,
        "default": "designer"
      },
      "state": {
        "type": "@DesignerState",
        "readOnly": false,
        "mandatory": false,
        "default": {}
      },
      "runWindow": {
        "type": "object",
        "readOnly": false,
        "mandatory": false,
        "default": null
      },
      "debugWindow": {
        "type": "object",
        "readOnly": false,
        "mandatory": false,
        "default": null
      },
      "updateRouter": {},
      "syncModel": {
        "params": [
          {
            "name": "schema",
            "type": "object",
            "mandatory": false,
            "default": {}
          }
        ]
      },
      "syncBehavior": {
        "params": [
          {
            "name": "model",
            "type": "object",
            "mandatory": false,
            "default": {}
          }
        ]
      },
      "syncComponent": {
        "params": [
          {
            "name": "model",
            "type": "object",
            "mandatory": false,
            "default": {}
          },
          {
            "name": "forceDelete",
            "type": "boolean",
            "mandatory": false,
            "default": true
          }
        ]
      },
      "createModel": {
        "params": [
          {
            "name": "schema",
            "type": "object",
            "mandatory": false,
            "default": {}
          }
        ]
      },
      "createBehavior": {
        "params": [
          {
            "name": "type",
            "type": "string",
            "mandatory": false,
            "default": "method"
          },
          {
            "name": "model",
            "type": "string",
            "mandatory": false,
            "default": ""
          },
          {
            "name": "state",
            "type": "string",
            "mandatory": false,
            "default": ""
          },
          {
            "name": "def",
            "type": "object",
            "mandatory": false,
            "default": {}
          }
        ]
      },
      "deleteSchema": {
        "params": [
          {
            "name": "schemaId",
            "type": "string",
            "mandatory": false,
            "default": ""
          }
        ]
      },
      "linkModel": {
        "params": [
          {
            "name": "source",
            "type": "string",
            "mandatory": false,
            "default": ""
          },
          {
            "name": "target",
            "type": "string",
            "mandatory": false,
            "default": ""
          }
        ]
      },
      "save": {},
      "saveCordova": {},
      "saveAs": {
        "params": [
          {
            "name": "data",
            "type": "object",
            "mandatory": false,
            "default": {}
          },
          {
            "name": "fileName",
            "type": "string",
            "mandatory": false,
            "default": ""
          }
        ]
      },
      "welcome": {},
      "generateId": {
        "result": "string"
      },
      "open": {
        "params": [
          {
            "name": "url",
            "type": "string",
            "mandatory": false,
            "default": ""
          },
          {
            "name": "target",
            "type": "string",
            "mandatory": false,
            "default": ""
          },
          {
            "name": "isExt",
            "type": "boolean",
            "mandatory": false,
            "default": false
          }
        ]
      },
      "render": {},
      "logs": {
        "type": [
          "@Log"
        ],
        "readOnly": false,
        "mandatory": false,
        "default": []
      },
      "isCordova": {
        "result": "boolean"
      },
      "isElectron": {
        "result": "boolean"
      },
      "updateCordovaContext": {},
      "messages": {
        "type": "array",
        "readOnly": false,
        "mandatory": false,
        "default": []
      },
      "runMessages": {
        "params": [
          {
            "name": "messages",
            "type": "array",
            "mandatory": true,
            "default": []
          }
        ]
      },
      "lastPage": {
        "type": "string",
        "readOnly": false,
        "mandatory": false,
        "default": "index.html"
      },
      "getGeneratedSchema": {
        "params": [
          {
            "name": "schema",
            "type": "string",
            "mandatory": true,
            "default": ""
          }
        ],
        "result": "object"
      },
      "getGeneratedModel": {
        "params": [
          {
            "name": "model",
            "type": "string",
            "mandatory": true,
            "default": ""
          }
        ],
        "result": "object"
      },
      "mergeBehavior": {
        "params": [
          {
            "name": "behaviors",
            "type": "object",
            "mandatory": true,
            "default": {}
          },
          {
            "name": "behavior",
            "type": "object",
            "mandatory": true,
            "default": {}
          },
          {
            "name": "sysId",
            "type": "string",
            "mandatory": true,
            "default": ""
          },
          {
            "name": "systemName",
            "type": "string",
            "mandatory": true,
            "default": ""
          }
        ]
      }
    }
  },
  "behaviors": {
    "i1a1951779613207": {
      "_id": "i1a1951779613207",
      "component": "udbc51200e11z02",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-select-all').tooltip('hide');\n  this.require('editor').selectAll(); \n}"
    },
    "d1d8ee1ac3812186": {
      "_id": "d1d8ee1ac3812186",
      "component": "udbc51200e11z01",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-redo').tooltip('hide');\n  this.require('editor').redo(); \n}"
    },
    "i15954170f111203": {
      "_id": "i15954170f111203",
      "component": "udbc51200e11z00",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-undo').tooltip('hide');\n  this.require('editor').undo(); \n}"
    },
    "y1dbc0114c11c791": {
      "_id": "y1dbc0114c11c791",
      "component": "1dbc51200e116e9",
      "state": "click",
      "action": "function click() {\n  $('#designer-toolbar-item-save').tooltip('hide');\n  this.require('designer').save(); \n}"
    },
    "j1ac7610be61012b": {
      "_id": "j1ac7610be61012b",
      "component": "1dbc51200e11615",
      "state": "click",
      "action": "function click() { \n  $('#designer-toolbar-item-help').tooltip('hide');\n  this.require('designer').open('https://system-designer.readme.io/docs/edit-a-model', '_blank', true); \n}"
    },
    "g161d21f3a912625": {
      "_id": "g161d21f3a912625",
      "component": "1dbc51200e11610",
      "state": "click",
      "action": "function click() {\n  $('#designer-toolbar-item-copyright').tooltip('hide');\n  var DialogCopyright = this.require('DialogCopyright');\n  var message = this.require('copyright.html');\n  \n  DialogCopyright = new DialogCopyright({\n    'title': 'System Designer',\n    'message': message.source().replace('{{version}}', this.require('designer').version())\n  });\n  DialogCopyright.show();\n  DialogCopyright.on('ok', function () {\n    this.hide();\n  });\n}"
    },
    "d1802118f46183c0": {
      "_id": "d1802118f46183c0",
      "component": "Workspace",
      "state": "render",
      "action": "function render() { \n  var Editor = null,\n    designer = null,\n    editor = null;\n\n  Editor = this.require('Editor');\n  designer = this.require('designer');\n\n  if (designer.isCordova()) {\n    editor = new Editor({\n      '_id': 'editor',\n      'type': 'codemirror',\n      'context': 'model',\n      'editor': CodeMirror($('#designer-editor')[0], {\n        lineNumbers: true,\n        styleActiveLine: true,\n        'mode': 'application/json',\n        'theme': 'eclipse',\n        'tabSize': 2,\n        'autoCloseBrackets': true\n      })\n    });\n  } else {\n    editor = new Editor({\n      '_id': 'editor',\n      'type': 'ace',\n      'context': 'model',\n      'editor': ace.edit('designer-editor')\n    });\n  }\n  \n  editor.render();\n}",
      "useCoreAPI": false,
      "core": false
    },
    "a1b93f164ee17347": {
      "_id": "a1b93f164ee17347",
      "component": "Server",
      "state": "start",
      "action": "function start() { \n  var RuntimeChannel = null,\n    channel = null,\n    id = '',\n    system = null,\n    editor = this.require('editor'),\n    designer = this.require('designer'),\n    modelName = '',\n    modelGen = null;\n\n  this.require('storage').on('changed', function (obj) {\n    if (typeof obj['system-designer-message'] !== 'undefined') {\n      $db._Message.insert(obj['system-designer-message'].newValue);\n    }\n  }, true);\n\n  RuntimeChannel = this.require('_Channel');\n  channel = new RuntimeChannel({\n    '_id': 'channel'\n  });\n\n  channel.on('send', function (message) {\n    if (message.event.indexOf('$system') !== 0) {\n      var config = this.require('storage').get('system-designer-config'),\n        designer = this.require('designer'),\n        messages = [];\n\n      if (designer.isCordova()) {\n        messages = designer.messages();\n        messages.push(message);\n        designer.messages(messages);\n      }\n\n      this.require('storage').set('system-designer-message', message);\n\n      // message for server debug\n      if (typeof config !== 'undefined' && typeof config.debugType !== 'undefined' && config.debugType === 'server' && config.urlServer) {\n        $.post(config.urlServer + ':8888/' + message.event, encodeURIComponent(JSON.stringify(message.data)));\n      }\n    }\n  });\n\n  id = document.location.href.split('#')[1].split('?')[0];\n  systemId = document.location.href.split('#')[2].split('?')[0];\n\n  system = this.require('storage').get(systemId);\n  model = system.models[id];\n\n  this.require('store').uuid(id);\n  this.require('store').data(model);\n\n  modelName = system.models[id]._name;\n  modelGen = designer.getGeneratedModel(modelName);\n  this.require('store').extra(modelGen);\n\n  document.title = 'model ' + model._name + ' · system ' + system.name;\n\n  editor.initValue(JSON.stringify(model, null, '\\t'), 2);\n}",
      "useCoreAPI": true,
      "core": false
    },
    "x1cd3e156f81600f": {
      "_id": "x1cd3e156f81600f",
      "component": "Designer",
      "state": "render",
      "action": "function render() {\n  var systemId = '',\n    System = null,\n    system = null,\n    sys = null;\n\n  // type\n  this.type(window.location.href.split('.html')[0].split('/')[window.location.href.split('.html')[0].split('/').length - 1].split('?')[0]);\n\n  if (this.isCordova()) {\n    this.updateCordovaContext();\n  }\n\n  // set system\n  systemId = document.location.href.split('#')[2].split('?')[0];\n  system = this.require('storage').get(systemId);\n  System = this.require('System');\n  sys = new System(system);\n  this.system(sys);\n\n  // render\n  this.require('menubar').render();\n  this.require('toolbar').render();\n  this.require('workspace').render();\n  this.require('server').start();\n\n  this.updateRouter();\n}",
      "useCoreAPI": false,
      "core": false
    },
    "r1c99315b98115e6": {
      "_id": "r1c99315b98115e6",
      "component": "Designer",
      "state": "updateRouter",
      "action": "function updateRouter() { \n  var menubar = [],\n    i = 0,\n    length = 0,\n    id = '',\n    href = '';\n\n  id = decodeURIComponent(document.location.href.split('#')[1]);\n  collection = document.location.href.split('#')[2];\n\n  // update menubar\n  menubar = $('#designer-menubar-items > li > a');\n  length = menubar.length;\n  for (i = 0; i < length; i++) {\n    href = menubar[i].href;\n    context = href.split('#')[href.split('#').length - 1];\n    menubar[i].href = '#' + id + '#' + collection + '#' + context;\n  }\n}",
      "useCoreAPI": false,
      "core": false
    },
    "s1bc6b11e9a13afd": {
      "_id": "s1bc6b11e9a13afd",
      "component": "Designer",
      "state": "save",
      "action": "function save() { \n  var val = this.require('editor').getValue(),\n    designer = this.require('designer'),\n    message = this.require('message'),\n    model = null,\n    property = '',\n    modelGen = null;\n\n  try {\n    model = JSON.parse(val);\n  } catch (e) {\n    message.danger('Can not save your model: your model has an invalid structure.');\n    return;\n  }\n\n  if (!model._name) {\n    message.danger('The property \\'_name\\' is missing.');\n    return;\n  }\n\n  if (!model._id) {\n    message.danger('The property \\'_id\\' is missing.');\n    return;\n  }\n\n  for (property in model) {\n    if (property.indexOf(' ') !== -1) {\n      message.danger('Invalid property name \\'' + property + '\\’. <br>Space is not authorized in the name of a property.');\n      return;\n    }\n    propVal = model[property];\n    if (typeof propVal === 'object' && !Array.isArray(propVal) && property.indexOf('_') === 0) {\n      message.danger('Invalid property name \\'' + property + '\\’. <br>A property name can not start with \\'_\\'.');\n      return;\n    }\n  }\n\n  modelGen = this.require('store').extra();\n  for (property in model) {\n    if (property.indexOf('_') !== 0 && typeof modelGen[property] === 'undefined') {\n      message.danger('Invalid property name \\'' + property + '\\’. <br>\\'' + property + '\\’ must be defined in the schema.');\n      return;\n    }\n  }\n\n  if (this.require('store').data()._name === model._name) {\n    this.require('store').data(model);\n\n    // check if ID change\n    if (this.require('store').uuid() !== this.require('store').data()._id) {\n      this.require('channel').$editorUpdateModelId(this.require('store').uuid(), this.require('store').data()._id);\n      this.require('store').uuid(this.require('store').data()._id);\n    }\n\n    this.require('channel').$editorUpdateModel(this.require('store').uuid(), this.require('store').data());\n    message.clean();\n    message.success('Model saved.');\n  } else {\n    message.danger('You can not modify the name of a model.');\n  }\n}",
      "useCoreAPI": false,
      "core": false
    },
    "z1b1ad1fdbb1a46a": {
      "_id": "z1b1ad1fdbb1a46a",
      "component": "w1a78b16d7311831",
      "state": "start",
      "action": "function start() { \n  this.require('designer').render();\n}",
      "useCoreAPI": false,
      "core": false
    }
  },
  "types": {},
  "components": {
    "ToolBarItem": {
      "1dbc51200e11610": {
        "_id": "1dbc51200e11610",
        "html": "toolbar-item-copyright.html",
        "position": 90,
        "type": "model"
      },
      "1dbc51200e11615": {
        "_id": "1dbc51200e11615",
        "html": "toolbar-item-help.html",
        "position": 80,
        "type": "model"
      },
      "1dbc51200e116e9": {
        "_id": "1dbc51200e116e9",
        "html": "toolbar-item-save.html",
        "position": 10,
        "type": "model"
      },
      "udbc51200e11z00": {
        "_id": "udbc51200e11z00",
        "html": "toolbar-item-undo.html",
        "position": 20,
        "type": "model"
      },
      "udbc51200e11z01": {
        "_id": "udbc51200e11z01",
        "html": "toolbar-item-redo.html",
        "position": 30,
        "type": "model"
      },
      "udbc51200e11z02": {
        "_id": "udbc51200e11z02",
        "html": "toolbar-item-select-all.html",
        "position": 40,
        "type": "model"
      }
    },
    "Designer": {},
    "MenuItem": {
      "1f1781882618108": {
        "_id": "1f1781882618108",
        "name": "model",
        "html": "menu-item-model.html",
        "position": 10,
        "type": "model"
      }
    },
    "MenuAction": {
      "1f8571164c179bh": {
        "_id": "1f8571164c179bh",
        "html": "menu-action-version.html",
        "position": 10,
        "type": "model"
      }
    },
    "MenuHeader": {
      "1fb101b99813a16": {
        "_id": "1fb101b99813a16",
        "html": "menu-header-model.html",
        "type": "model"
      }
    },
    "Workspace": {}
  },
  "_id": "w1a78b16d7311831"
}